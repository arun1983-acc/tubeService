async function fetchTubeStatus() {
    try {
        // Fetch Tube status
        const tubeResponse = await fetch('https://api.tfl.gov.uk/Line/Mode/tube/Status');
        const tubeData = await tubeResponse.json();

        // Fetch Elizabeth Line (Rail mode) status
        const railResponse = await fetch('https://api.tfl.gov.uk/Line/Elizabeth/Status');
        const railData = await railResponse.json();

        // Combine the data from Tube and Rail modes
        const allData = [...tubeData, ...railData];

        const statusContainer = document.getElementById('status-container');
        statusContainer.innerHTML = ''; // Clear previous status

        allData.forEach(line => {
            const lineStatus = document.createElement('div');
            lineStatus.classList.add('line-status');

            // Check for "Good Service" or any disruptions
            if (line.lineStatuses[0].statusSeverityDescription === 'Good Service') {
                lineStatus.classList.add('good-service');
            } else {
                lineStatus.classList.add('disrupted');
            }

            // Show line name and status description
            lineStatus.innerText = `${line.name}: ${line.lineStatuses[0].statusSeverityDescription}`;
            statusContainer.appendChild(lineStatus);
        });

        // Update last updated time
        const now = new Date();
        document.getElementById('last-updated').innerText = 
            `Last updated: ${now.toLocaleTimeString()}`;

    } catch (error) {
        console.error('Error fetching data:', error);
        document.getElementById('status-container').innerHTML = 
            '<p>⚠️ Failed to load Tube status.</p>';
    }
}

// Fetch data immediately and then every 30 seconds
fetchTubeStatus();
setInterval(fetchTubeStatus, 30000);
